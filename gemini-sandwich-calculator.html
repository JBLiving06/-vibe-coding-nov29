<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sandwich Generation Squeeze Mapper | Gemini Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .slider-thumb::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: #6366f1;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // Cost Tier Multipliers
        const COST_TIERS = {
            LCOL: { label: 'Low Cost Area', multiplier: 0.75 },
            MCOL: { label: 'Medium Cost Area', multiplier: 1.0 },
            HCOL: { label: 'High Cost Area', multiplier: 1.5 },
            VHCOL: { label: 'Very High Cost (NYC/SF)', multiplier: 2.2 }
        };

        // Parent Care Stage Costs
        const PARENT_STAGES = {
            INDEPENDENT: { baseCost: 300, label: "Independent", color: "#10b981" },
            HOME_HELP: { baseCost: 2500, label: "Home Health Aides", color: "#f59e0b" },
            ASSISTED: { baseCost: 5500, label: "Assisted Living", color: "#f97316" },
            NURSING: { baseCost: 9500, label: "Skilled Nursing", color: "#ef4444" }
        };

        // Child Support Stage Costs
        const CHILD_STAGES = {
            K12_PUBLIC: { baseCost: 800, label: "K-12 (Public + Activities)", color: "#3b82f6" },
            K12_PRIVATE: { baseCost: 2500, label: "K-12 (Private)", color: "#2563eb" },
            COLLEGE_PUBLIC: { baseCost: 2500, label: "College (In-State)", color: "#8b5cf6" },
            COLLEGE_PRIVATE: { baseCost: 5500, label: "College (Private)", color: "#7c3aed" },
            LAUNCHING: { baseCost: 1200, label: "Young Adult (Support)", color: "#d946ef" },
            INDEPENDENT: { baseCost: 0, label: "Financially Independent", color: "#9ca3af" }
        };

        function Icon({ name, className }) {
            const icons = {
                user: <path strokeLinecap="round" strokeLinejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />,
                plus: <path strokeLinecap="round" strokeLinejoin="round" d="M12 4.5v15m7.5-7.5h-15" />,
                trash: <path strokeLinecap="round" strokeLinejoin="round" d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0" />,
                chart: <path strokeLinecap="round" strokeLinejoin="round" d="M3.75 3v11.25A2.25 2.25 0 006 16.5h2.25M6 16.5v2.25m2.25-2.25v2.25m4.5 0h2.25m-2.25 0v-2.25m2.25 2.25v-2.25m-2.25 0h-2.25m2.25 0V6.75a2.25 2.25 0 00-2.25-2.25H12m4.5 9.75v3m-9.75-3.75h3.75" />
            };
            return <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" strokeWidth={1.5} stroke="currentColor" className={className}>{icons[name]}</svg>;
        }

        function App() {
            const [yearsToProject] = useState(15);
            const [userAge, setUserAge] = useState(50);
            
            const [parents, setParents] = useState([
                { id: 1, name: "Mom", age: 78, health: "FRAIL", location: "MCOL" }
            ]);
            const [kids, setKids] = useState([
                { id: 1, name: "Child", age: 19, track: "COLLEGE_PUBLIC", location: "MCOL" }
            ]);

            const getParentCost = (p, yearIndex) => {
                const currentAge = p.age + yearIndex;
                let stage = PARENT_STAGES.INDEPENDENT;

                if (p.health === "ROBUST") {
                    if (currentAge >= 85) stage = PARENT_STAGES.HOME_HELP;
                    if (currentAge >= 92) stage = PARENT_STAGES.ASSISTED;
                } else if (p.health === "FRAIL") {
                    if (currentAge >= 80) stage = PARENT_STAGES.ASSISTED;
                    if (currentAge >= 88) stage = PARENT_STAGES.NURSING;
                } else if (p.health === "NEEDS_CARE") {
                    if (currentAge >= p.age) stage = PARENT_STAGES.ASSISTED;
                    if (currentAge >= p.age + 5) stage = PARENT_STAGES.NURSING;
                }

                const multiplier = COST_TIERS[p.location].multiplier;
                return { cost: stage.baseCost * multiplier, label: stage.label };
            };

            const getKidCost = (k, yearIndex) => {
                const currentAge = k.age + yearIndex;
                let stage = CHILD_STAGES.INDEPENDENT;
                
                if (currentAge < 18) {
                    stage = k.track === "PRIVATE_SCHOOL" ? CHILD_STAGES.K12_PRIVATE : CHILD_STAGES.K12_PUBLIC;
                } else if (currentAge >= 18 && currentAge < 22) {
                    if (k.track.includes("COLLEGE")) {
                        stage = k.track === "COLLEGE_PRIVATE" ? CHILD_STAGES.COLLEGE_PRIVATE : CHILD_STAGES.COLLEGE_PUBLIC;
                    } else {
                        stage = CHILD_STAGES.LAUNCHING;
                    }
                } else if (currentAge >= 22 && currentAge < 25) {
                    stage = CHILD_STAGES.LAUNCHING;
                }

                const multiplier = COST_TIERS[k.location].multiplier;
                return { cost: stage.baseCost * multiplier, label: stage.label };
            };

            const projectionData = useMemo(() => {
                const data = [];
                let maxTotal = 0;

                for (let i = 0; i <= yearsToProject; i++) {
                    const yearLabel = new Date().getFullYear() + i;
                    const userAgeNow = userAge + i;
                    
                    let parentTotal = 0;
                    let kidTotal = 0;
                    const details = [];

                    parents.forEach(p => {
                        const { cost, label } = getParentCost(p, i);
                        parentTotal += cost;
                        details.push({ name: p.name, cost, label, type: 'parent' });
                    });

                    kids.forEach(k => {
                        const { cost, label } = getKidCost(k, i);
                        kidTotal += cost;
                        details.push({ name: k.name, cost, label, type: 'kid' });
                    });

                    const total = parentTotal + kidTotal;
                    if (total > maxTotal) maxTotal = total;

                    data.push({ year: yearLabel, userAge: userAgeNow, parentTotal, kidTotal, total, details });
                }
                return { data, maxTotal };
            }, [parents, kids, userAge, yearsToProject]);

            const addParent = () => setParents([...parents, { id: Date.now(), name: "Parent", age: 75, health: "ROBUST", location: "MCOL" }]);
            const updateParent = (id, field, value) => setParents(parents.map(p => p.id === id ? { ...p, [field]: value } : p));
            const removeParent = (id) => setParents(parents.filter(p => p.id !== id));

            const addKid = () => setKids([...kids, { id: Date.now(), name: "Child", age: 16, track: "COLLEGE_PUBLIC", location: "MCOL" }]);
            const updateKid = (id, field, value) => setKids(kids.map(k => k.id === id ? { ...k, [field]: value } : k));
            const removeKid = (id) => setKids(kids.filter(k => k.id !== id));

            const Chart = ({ data, maxVal }) => {
                return (
                    <div className="relative h-[350px] w-full mt-6 select-none">
                        <div className="absolute left-0 top-0 bottom-8 w-full flex flex-col justify-between text-xs text-gray-400 z-0">
                            {[1, 0.75, 0.5, 0.25, 0].map(pct => (
                                <div key={pct} className="border-b border-gray-200 w-full h-0 flex items-center">
                                    <span className="bg-gray-100 pr-2 absolute left-0 -top-2">${Math.round(maxVal * pct).toLocaleString()}</span>
                                </div>
                            ))}
                        </div>
                        
                        <div className="absolute inset-0 flex items-end justify-between pl-12 pb-8 z-10 space-x-1">
                            {data.map((d, i) => {
                                const parentHeight = (d.parentTotal / maxVal) * 100;
                                const kidHeight = (d.kidTotal / maxVal) * 100;
                                const isPeak = d.total === maxVal;
                                
                                return (
                                    <div key={i} className="flex flex-col items-center flex-1 h-full justify-end group relative">
                                        <div className="hidden group-hover:block absolute bottom-full mb-2 bg-gray-900 text-white text-xs rounded p-2 whitespace-nowrap z-50 shadow-lg">
                                            <div className="font-bold mb-1">{d.year} (Age {d.userAge})</div>
                                            <div>Parents: ${d.parentTotal.toLocaleString()}</div>
                                            <div>Kids: ${d.kidTotal.toLocaleString()}</div>
                                            <div className="border-t border-gray-700 mt-1 pt-1 text-yellow-400">Total: ${d.total.toLocaleString()}/mo</div>
                                        </div>

                                        <div className="w-full max-w-[40px] flex flex-col-reverse rounded-t-sm overflow-hidden transition-all duration-300 hover:opacity-90">
                                            <div style={{ height: `${parentHeight}%` }} className="bg-orange-400 w-full"></div>
                                            <div style={{ height: `${kidHeight}%` }} className="bg-blue-500 w-full"></div>
                                        </div>
                                        
                                        <div className={`text-[10px] mt-2 ${isPeak ? 'font-bold text-red-600' : 'text-gray-500'}`}>{d.year}</div>
                                        <div className="text-[9px] text-gray-400">{d.userAge}</div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const peak = projectionData.data.reduce((max, curr) => curr.total > max.total ? curr : max, projectionData.data[0]);

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-6xl mx-auto">
                    <header className="mb-8">
                        <h1 className="text-3xl font-bold text-gray-800 flex items-center gap-2">
                            <Icon name="chart" className="w-8 h-8 text-indigo-600" />
                            Sandwich Generation Squeeze Mapper
                        </h1>
                        <p className="text-gray-600 mt-2 max-w-3xl">
                            Visualize the overlapping financial pressure of supporting aging parents and launching children while saving for retirement.
                        </p>
                        <div className="mt-1 text-sm text-purple-600">Powered by Gemini</div>
                    </header>

                    <div className="grid grid-cols-1 lg:grid-cols-12 gap-8">
                        <div className="lg:col-span-4 space-y-6">
                            <div className="bg-white p-5 rounded-xl shadow-sm">
                                <label className="block text-sm font-medium text-gray-700 mb-2">My Current Age</label>
                                <div className="flex items-center gap-4">
                                    <input type="range" min="40" max="65" value={userAge} onChange={(e) => setUserAge(parseInt(e.target.value))} className="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-thumb" />
                                    <span className="text-xl font-bold text-indigo-600 w-12">{userAge}</span>
                                </div>
                            </div>

                            <div className="bg-white p-5 border-l-4 border-orange-400 rounded-xl shadow-sm">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-lg font-bold text-gray-800">Aging Parents</h2>
                                    <button onClick={addParent} className="text-sm bg-orange-100 text-orange-700 px-3 py-1 rounded-full hover:bg-orange-200 font-medium flex items-center gap-1">
                                        <Icon name="plus" className="w-4 h-4" /> Add
                                    </button>
                                </div>
                                <div className="space-y-4">
                                    {parents.map(p => (
                                        <div key={p.id} className="bg-gray-50 p-3 rounded-md relative group">
                                            <button onClick={() => removeParent(p.id)} className="absolute top-2 right-2 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <Icon name="trash" className="w-4 h-4" />
                                            </button>
                                            <div className="grid grid-cols-2 gap-2 mb-2">
                                                <input value={p.name} onChange={(e) => updateParent(p.id, 'name', e.target.value)} className="bg-transparent font-bold text-gray-700 border-b border-gray-300 focus:border-orange-500 outline-none w-full" />
                                                <div className="flex items-center justify-end text-sm">Age: 
                                                    <input type="number" value={p.age} onChange={(e) => updateParent(p.id, 'age', parseInt(e.target.value))} className="ml-2 w-12 p-1 border rounded text-center" />
                                                </div>
                                            </div>
                                            <div className="grid grid-cols-1 gap-2">
                                                <select value={p.health} onChange={(e) => updateParent(p.id, 'health', e.target.value)} className="text-sm w-full p-2 border rounded bg-white">
                                                    <option value="ROBUST">Robust Health</option>
                                                    <option value="FRAIL">Frail (Likely care soon)</option>
                                                    <option value="NEEDS_CARE">Needs Care Now</option>
                                                </select>
                                                <select value={p.location} onChange={(e) => updateParent(p.id, 'location', e.target.value)} className="text-sm w-full p-2 border rounded bg-white">
                                                    {Object.keys(COST_TIERS).map(k => (
                                                        <option key={k} value={k}>{COST_TIERS[k].label}</option>
                                                    ))}
                                                </select>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="bg-white p-5 border-l-4 border-blue-500 rounded-xl shadow-sm">
                                <div className="flex justify-between items-center mb-4">
                                    <h2 className="text-lg font-bold text-gray-800">Children</h2>
                                    <button onClick={addKid} className="text-sm bg-blue-100 text-blue-700 px-3 py-1 rounded-full hover:bg-blue-200 font-medium flex items-center gap-1">
                                        <Icon name="plus" className="w-4 h-4" /> Add
                                    </button>
                                </div>
                                <div className="space-y-4">
                                    {kids.map(k => (
                                        <div key={k.id} className="bg-gray-50 p-3 rounded-md relative group">
                                            <button onClick={() => removeKid(k.id)} className="absolute top-2 right-2 text-gray-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity">
                                                <Icon name="trash" className="w-4 h-4" />
                                            </button>
                                            <div className="grid grid-cols-2 gap-2 mb-2">
                                                <input value={k.name} onChange={(e) => updateKid(k.id, 'name', e.target.value)} className="bg-transparent font-bold text-gray-700 border-b border-gray-300 focus:border-blue-500 outline-none w-full" />
                                                <div className="flex items-center justify-end text-sm">Age: 
                                                    <input type="number" value={k.age} onChange={(e) => updateKid(k.id, 'age', parseInt(e.target.value))} className="ml-2 w-12 p-1 border rounded text-center" />
                                                </div>
                                            </div>
                                            <div className="grid grid-cols-1 gap-2">
                                                <select value={k.track} onChange={(e) => updateKid(k.id, 'track', e.target.value)} className="text-sm w-full p-2 border rounded bg-white">
                                                    <option value="K12_PUBLIC">Public School → Public College</option>
                                                    <option value="PRIVATE_SCHOOL">Private School → Private College</option>
                                                    <option value="COLLEGE_PUBLIC">College (In-State)</option>
                                                    <option value="COLLEGE_PRIVATE">College (Private)</option>
                                                </select>
                                                <select value={k.location} onChange={(e) => updateKid(k.id, 'location', e.target.value)} className="text-sm w-full p-2 border rounded bg-white">
                                                    {Object.keys(COST_TIERS).map(k => (
                                                        <option key={k} value={k}>{COST_TIERS[k].label}</option>
                                                    ))}
                                                </select>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>

                        <div className="lg:col-span-8 flex flex-col gap-6">
                            <div className="bg-white p-6 min-h-[400px] rounded-xl shadow-sm">
                                <h3 className="text-xl font-bold text-gray-800 mb-2">15-Year Financial Pressure Projection</h3>
                                <p className="text-sm text-gray-500 mb-4">Estimated Monthly Obligations (Care + Support)</p>
                                
                                {projectionData.maxTotal > 0 ? (
                                    <Chart data={projectionData.data} maxVal={projectionData.maxTotal * 1.1} />
                                ) : (
                                    <div className="h-64 flex items-center justify-center text-gray-400">Add family members to see projection</div>
                                )}
                                
                                <div className="flex items-center justify-center gap-6 mt-6 text-sm">
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 bg-orange-400 rounded"></div>
                                        <span>Elder Care Costs</span>
                                    </div>
                                    <div className="flex items-center gap-2">
                                        <div className="w-4 h-4 bg-blue-500 rounded"></div>
                                        <span>Child Support/Edu</span>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-indigo-900 text-white p-6 rounded-xl shadow-sm">
                                <h3 className="text-lg font-bold mb-4 flex items-center gap-2">
                                    <Icon name="chart" className="w-5 h-5" />
                                    The "Squeeze" Analysis
                                </h3>
                                <div className="space-y-4">
                                    <div className="flex items-start gap-4">
                                        <div className="text-4xl font-bold text-indigo-300">${peak.total.toLocaleString()}</div>
                                        <div>
                                            <p className="font-semibold text-indigo-100">Peak Monthly Cost</p>
                                            <p className="text-sm text-indigo-300">Occurs in {peak.year} (You are {peak.userAge})</p>
                                        </div>
                                    </div>
                                    
                                    <div className="bg-indigo-800/50 rounded-lg p-4 mt-2">
                                        <h4 className="font-bold text-indigo-200 mb-2 text-sm uppercase tracking-wide">Pressure Points in {peak.year}:</h4>
                                        <ul className="space-y-2 text-sm">
                                            {peak.details.filter(d => d.cost > 0).map((d, i) => (
                                                <li key={i} className="flex justify-between items-center">
                                                    <span>{d.name} ({d.label})</span>
                                                    <span className="font-mono">${d.cost.toLocaleString()}</span>
                                                </li>
                                            ))}
                                        </ul>
                                    </div>

                                    <div className="text-sm text-indigo-200 italic mt-2">
                                        * Note: This model assumes costs rise with care needs. It does not account for general inflation.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <footer className="text-center mt-12 text-gray-500 text-sm">
                        <p>Built with Gemini | Broganda Vibe Coding Workshop | November 30, 2025</p>
                    </footer>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
